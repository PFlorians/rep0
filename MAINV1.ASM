		TITLE ZADANIE1
		INCLUDE UMACROS.INC
		INCLUDE BIOSMACROS.INC
		INCLUDE FILEMACRO.INC
		
		STK SEGMENT STACK
			DW 64 DUP(?);
		STK ENDS
		SEGMENT DATA
			ENT DB 10, 13, '$'
			MENU1 DB 10, 13, 'A) ZADAT MENO SUBORU', 10, 13, '$'
			MENU2 DB 'B) VYPISAT OBSAH SUBORU', 10, 13, '$'
			MENU3 DB 'C) NACITAT RETAZEC A VYPISAT POCET VYSKYTOV', 10, 13, '$'
			MENU4 DB 'D) UKONCIT PROGRAM', 10, 13, '$'
			;DATOVA STRUKTURA PRE ULOZENIE VSTUPU NAZVU RETAZCA
			INP DB 100 
			POCET DB 0;REALNY POCET ZNAKOV V RETAZCI
				  DB 103 DUP(0);BUFFER VELKOSTI 100
			;DATA KDE JE ZALOZNY RETAZEC
			FNAME DB 103 DUP(0);
			;FILE HANDLE TEMPORARY STORAGE
			HANDLE DW ?  ;POZN. AX JE 16 BITOV
			;BUFFER PRE DATA ZO SUBORU
			BUFFER DB 200 DUP(0)
		DATA ENDS
		
		SEGMENT CODE
			ASSUME CS:CODE, DS:DATA, SS:STK
			;LOKALNE PROCEDURY ZATIAL TU
			FILENAME PROC
					SETFNAME
					CLEAR
					MOVESTART ;REALIZUJ PRESUN KURZORA NA PRVU MOZNU POZICIU
					BACKUPSTRING
					;print nazov suboru
					LEA DX, POCET[1]
					MOV AH, 09H
					INT 21H
					RET
					;JMP MAINLOOP
					;TMP SHOULD BE UNREACHABLE OTHER THAN AL, 44H
			FILENAME ENDP
			READFILE PROC
				FOPEN
				FREAD
				;FCLOSE
				RET
			READFILE ENDP
			START:
					MOV AX, SEG DATA
					MOV DS, AX
			MAINLOOP:
					MENU MENU1, MENU2, MENU3, MENU4
					USERINPUT	;BUDE BUFFROVAT DO CL
					PRINTENTER
					MOV AL, CL
					CMP AL, 41H
						JZ MENO
					CMP AL, 42H
						JZ FPRINT
					CMP AL, 43H
						JZ SUBS
					CMP AL, 44H
						JZ KONIEC
						JNE EL
			MENO:
				CALL FILENAME
				JMP MAINLOOP
			FPRINT:
				CALL READFILE
				JMP MAINLOOP
			SUBS:
					;SUBSTRING SEARCH HERE
			EL:		;NASTANE AK INY VSTUP
					CLEAR;POZOR AK SA TOTO VOLA PRED PUTCHAR TAK SA PREMAZE VSTUP V REGISTROCH
					MOVESTART 
					XOR AX, AX
					JMP MAINLOOP ;ZACAT OD ZACIATKU, TOTO TRVA DOKIAL NEZADA 'D'
			KONIEC:
					MOV AX, 4C00H;UKONCI PROGRAM
					INT 21H
		CODE ENDS
		END START
